(function(e){var f={},a,n,r,o,u=750,g,l,k,q,m,d=false;function b(w,v,y,x){return Math.abs(w-v)>=Math.abs(y-x)?(w-v>0?"Left":"Right"):(y-x>0?"Up":"Down")}function j(){o=null;if(f.last){f.el.trigger("longTap");f={}}}function t(){if(o){clearTimeout(o)}o=null}function h(){if(a){clearTimeout(a)}if(n){clearTimeout(n)}if(r){clearTimeout(r)}if(o){clearTimeout(o)}a=n=r=o=null;f={}}function c(v){return(v.pointerType=="touch"||v.pointerType==v.MSPOINTER_TYPE_TOUCH)&&v.isPrimary}function i(w,v){return(w.type=="pointer"+v||w.type.toLowerCase()=="mspointer"+v)}function s(){if(!d){return}e(document).off(m.down,l).off(m.up,k).off(m.move,q).off(m.cancel,h);e(window).off("scroll",h);h();d=false}function p(A){var x,B,w=0,v=0,z,y;s();m=(A&&("down" in A))?A:("ontouchstart" in document?{"down":"touchstart","up":"touchend","move":"touchmove","cancel":"touchcancel"}:"onpointerdown" in document?{"down":"pointerdown","up":"pointerup","move":"pointermove","cancel":"pointercancel"}:"onmspointerdown" in document?{"down":"MSPointerDown","up":"MSPointerUp","move":"MSPointerMove","cancel":"MSPointerCancel"}:false);if(!m){return}if("MSGesture" in window){g=new MSGesture();g.target=document.body;e(document).bind("MSGestureEnd",function(D){var C=D.velocityX>1?"Right":D.velocityX<-1?"Left":D.velocityY>1?"Down":D.velocityY<-1?"Up":null;if(C){f.el.trigger("swipe");f.el.trigger("swipe"+C)}})}l=function(C){if((y=i(C,"down"))&&!c(C)){return}z=y?C:C.touches[0];if(C.touches&&C.touches.length===1&&f.x2){f.x2=undefined;f.y2=undefined}x=Date.now();B=x-(f.last||x);f.el=e("tagName" in z.target?z.target:z.target.parentNode);a&&clearTimeout(a);f.x1=z.pageX;f.y1=z.pageY;if(B>0&&B<=250){f.isDoubleTap=true}f.last=x;o=setTimeout(j,u);if(g&&y){g.addPointer(C.pointerId)}};q=function(C){if((y=i(C,"move"))&&!c(C)){return}z=y?C:C.touches[0];t();f.x2=z.pageX;f.y2=z.pageY;w+=Math.abs(f.x1-f.x2);v+=Math.abs(f.y1-f.y2)};k=function(C){if((y=i(C,"up"))&&!c(C)){return}t();if((f.x2&&Math.abs(f.x1-f.x2)>30)||(f.y2&&Math.abs(f.y1-f.y2)>30)){r=setTimeout(function(){if(f.el){f.el.trigger("swipe");f.el.trigger("swipe"+(b(f.x1,f.x2,f.y1,f.y2)))}f={}},0)}else{if("last" in f){if(w<30&&v<30){n=setTimeout(function(){var D=e.Event("tap");D.cancelTouch=h;if(f.el){f.el.trigger(D)}if(f.isDoubleTap){if(f.el){f.el.trigger("doubleTap")}f={}}else{a=setTimeout(function(){a=null;if(f.el){f.el.trigger("singleTap")}f={}},250)}},0)}else{f={}}}}w=v=0};e(document).on(m.up,k).on(m.down,l).on(m.move,q);e(document).on(m.cancel,h);e(window).on("scroll",h);d=true}["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(v){e.fn[v]=function(w){return this.on(v,w)}});e.touch={setup:p};e(document).ready(p)})(Zepto);
